**Лабораторная работа №5**

**Анализ файловой системы Linux. Команды для работы с файлами и каталогами**

Рябцев И.В.; НКАбд-03-22

**1	Цель работы**

Ознакомление с файловой системой Linux, её структурой, именами и содержанием каталогов. Приобретение практических навыков по применению команд для работы с файлами и каталогами, по управлению процессами (и работами), по проверке использования диска и обслуживанию файловой системы.

**2	Задание**

- Выполните все примеры, приведённые в первой части описания лабораторной работы.
- Выполните следующие действия, зафиксировав в отчёте по лабораторной работе используемые при этом команды и результаты их выполнения: 2.1. Скопируйте файл /usr/include/sys/io.h в домашний каталог и назовите его equipment. Если файла io.h нет, то используйте любой другой файл в каталоге /usr/include/sys/ вместо него. 2.2. В домашнем каталоге создайте директорию ~/ski.plases. 2.3. Переместите файл equipment в каталог ~/ski.plases. 2.4. Переименуйте файл ~/ski.plases/equipment в ~/ski.plases/equiplist. 2.5. Создайте в домашнем каталоге файл abc1 и скопируйте его в каталог ~/ski.plases, назовите его equiplist2. 2.6. Создайте каталог с именем equipment в каталоге ~/ski.plases. 2.7. Переместите файлы ~/ski.plases/equiplist и equiplist2 в каталог ~/ski.plases/equipment. 2.8. Создайте и переместите каталог ~/newdir в каталог ~/ski.plases и назовите его plans.
- Определите опции команды chmod, необходимые для того, чтобы присвоить перечисленным ниже файлам выделенные права доступа, считая, что в начале таких прав нет: 3.1. drwxr–r– … australia 3.2. drwx–x–x … play 3.3. -r-xr–r– … my\_os 3.4. -rw-rw-r– … feathers При необходимости создайте нужные файлы.
- Проделайте приведённые ниже упражнения, записывая в отчёт по лабораторной работе используемые при этом команды: 4.1. Просмотрите содержимое файла /etc/password. 4.2. Скопируйте файл ~/feathers в файл ~/file.old. 4.3. Переместите файл ~/file.old в каталог ~/play. 4.4. Скопируйте каталог ~/play в каталог ~/fun. 4.5. Переместите каталог ~/fun в каталог ~/play и назовите его games. 4.6. Лишите владельца файла ~/feathers права на чтение. 4.7. Что произойдёт, если вы попытаетесь просмотреть файл ~/feathers командой cat? 4.8. Что произойдёт, если вы попытаетесь скопировать файл ~/feathers? 4.9. Дайте владельцу файла ~/feathers право на чтение. 4.10. Лишите владельца каталога ~/play права на выполнение. 4.11. Перейдите в каталог ~/play. Что произошло? 4.12. Дайте владельцу каталога ~/play право на выполнение.
- Прочитайте man по командам mount, fsck, mkfs, kill и кратко их охарактеризуйте, приведя примеры.

**3	Теоретическое введение**

Файловая система (ФС) — архитектура хранения данных, которые могут находиться в разделах жесткого диска и ОП. Выдает пользователю доступ к конфигурации ядра. Определяет, какую структуру принимают файлы в каждом из разделов, создает правила для их генерации, а также управляет файлами в соответствии с особенностями каждой конкретной ФС [1] . Основные файловые системы, используемые в дистрибутивах Linux: Ext2; Ext3; Ext4; JFS; ReiserFS; XFS; Btrfs; ZFS. Ext2, Ext3, Ext4 или Extended Filesystem – стандартная файловая система, первоначально разработанная еще для Minix [2].

**4	Выполнение лабораторной работы**

- Выполним все примеры, приведённые в первой части описания лабораторной работы. (рис. 1-6)

*Рис. 1: Команда cp*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.001.png)


*Рис. 3: Команда mv*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.002.png)

*Рис. 4: Команда mv*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.003.png)

*Рис. 5: Команда chmod*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.004.png)

*Рис. 6: Команда chmod*

- Выполним следующие действия, зафиксировав в отчёте по лабораторной работе используемые при этом команды и результаты их выполнения: 2.1. Скопируйте файл /usr/include/sys/io.h в домашний каталог и назовите его equipment. Если файла io.h нет, то используйте любой другой файл в каталоге /usr/include/sys/ вместо него. (рис. 7)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.005.png)

*Рис. 7: Изменение имени файла io.h на equipment*

2.2. В домашнем каталоге создадим директорию ~/ski.plases. 2.3. Переместим файл equipment в каталог ~/ski.plases. 2.4. Переименуем файл ~/ski.plases/equipment в ~/ski.plases/equiplist. (рис. 8)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.006.png)

*Рис. 8: Создание каталога, перемещение файла в каталог, изменение имени файла*

2.5. Создадим в домашнем каталоге файл abc1 и скопируйте его в каталог ~/ski.plases, назовите его equiplist2. 2.6. Создадим каталог с именем equipment в каталоге ~/ski.plases. 2.7. Переместим файлы ~/ski.plases/equiplist и equiplist2 в каталог ~/ski.plases/equipment. (рис. 9, 10)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.007.png)

*Рис. 9: Создание и копирование каталога*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.008.png)

*Рис. 10: Перемещение каталога*

2.8. Создадим и переместим каталог ~/newdir в каталог ~/ski.plases и назовите его plans. (рис. 11)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.009.png)

*Рис. 11: Создание, перемещение и изменение имени каталога*

- Определим опции команды chmod, необходимые для того, чтобы присвоить перечисленным ниже файлам выделенные права доступа, считая, что в начале таких прав нет: 3.1. drwxr–r– … australia 3.2. drwx–x–x … play 3.3. -r-xr–r– … my\_os 3.4. -rw-rw-r– … feathers При необходимости создадим нужные файлы. (рис. 12, 13)

*Рис. 12: Команда chmod*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.010.png)

*Рис. 13: Команда chmod*

- Проделаем приведённые ниже упражнения, записывая в отчёт по лабораторной работе используемые при этом команды: 4.1. Просмотрим содержимое файла /etc/password. (рис. 14)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.011.png)

*Рис. 14: Просмотр содержимого файла*

4.2. Скопируем файл ~/feathers в файл ~/file.old. 4.3. Переместим файл ~/file.old в каталог ~/play. 4.4. Скопируем каталог ~/play в каталог ~/fun. (рис. 15)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.012.png)

*Рис. 15: Копирование и перемещение файла, копирование каталога в другой каталог*

4.5. Переместим каталог ~/fun в каталог ~/play и назовем его games. (рис. 16)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.013.png)

*Рис. 16: Перемещение и изменение имени каталога*

4.6. Лишим владельца файла ~/feathers права на чтение. 4.7. Что произойдёт, если вы попытаетесь просмотреть файл ~/feathers командой cat? 4.8. Что произойдёт, если вы попытаетесь скопировать файл ~/feathers? 4.9. Дадим владельцу файла ~/feathers право на чтение. 4.10. Лишим владельца каталога ~/play права на выполнение. (рис. 17)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.014.png)

*Рис. 17: Команды chmod и cat*

4.11. Перейдем в каталог ~/play. Что произошло? 4.12. Дадим владельцу каталога ~/play право на выполнение. (рис. 18)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.015.png)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.016.png)

*Рис. 18-19: Переход в каталог play, возвращение права на выполнение владельцу каталога*

- Прочитаем man по командам mount, fsck, mkfs, kill. (рис. 19-24)

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.017.png)

*Рис. 19: Команда man mount*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.018.png)

*Рис. 20: Команда mount*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.019.png)

*Рис. 21: Команда man fsck*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.020.png)

*Рис. 22: Команда man mkfs*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.021.png)

*Рис. 23: Команда man kill*

![](Aspose.Words.1d7f4982-7696-42e7-94a0-d0bcf2d59243.022.png)

*Рис. 24: Команда kill -l*

**5	Выводы**

Ознакомился с файловой системой Linux и с ее структурой. Научился использовать различные команды в терминале для работы с файлами и каталогами.

**6	Контрольные вопросы**

- Дайте характеристику каждой файловой системе, существующей на жёстком диске компьютера, на котором вы выполняли лабораторную работу.

Ext2, Ext3, Ext4 или Extended Filesystem - это стандартная файловая система для Linux. Она была разработана еще для Minix. Она самая стабильная из всех существующих, кодовая база изменяется очень редко и эта файловая система содержит больше всего функций. Версия ext2 была разработана уже именно для Linux и получила много улучшений. В 2001 году вышла ext3, которая добавила еще больше стабильности благодаря использованию журналирования. В 2006 была выпущена версия ext4, которая используется во всех дистрибутивах Linux до сегодняшнего дня. В ней было внесено много улучшений, в том числе увеличен максимальный размер раздела до одного экзабайта.

Btrfs или B-Tree File System - это совершенно новая файловая система, которая сосредоточена на отказоустойчивости, легкости администрирования и восстановления данных. Файловая система объединяет в себе очень много новых интересных возможностей, таких как размещение на нескольких разделах, поддержка подтомов, изменение размера не лету, создание мгновенных снимков, а также высокая производительность. Но многими пользователями файловая система Btrfs считается нестабильной. Тем не менее, она уже используется как файловая система по умолчанию в OpenSUSE и SUSE Linux.

- Приведите общую структуру файловой системы и дайте характеристику каждой директории первого уровня этой структуры.

/ — root каталог. Содержит в себе всю иерархию системы;

/bin — здесь находятся двоичные исполняемые файлы. Основные общие команды, хранящиеся отдельно от других программ в системе (прим.: pwd, ls, cat, ps);

/boot — тут расположены файлы, используемые для загрузки системы (образ initrd, ядро vmlinuz);

/dev — в данной директории располагаются файлы устройств (драйверов). С помощью этих файлов можно взаимодействовать с устройствами. К примеру, если это жесткий диск, можно подключить его к файловой системе. В файл принтера же можно написать напрямую и отправить задание на печать;

/etc — в этой директории находятся файлы конфигураций программ. Эти файлы позволяют настраивать системы, сервисы, скрипты системных демонов;

/home — каталог, аналогичный каталогу Users в Windows. Содержит домашние каталоги учетных записей пользователей (кроме root). При создании нового пользователя здесь создается одноименный каталог с аналогичным именем и хранит личные файлы этого пользователя;

/lib — содержит системные библиотеки, с которыми работают программы и модули ядра;

/lost+found — содержит файлы, восстановленные после сбоя работы системы. Система проведет проверку после сбоя и найденные файлы можно будет посмотреть в данном каталоге;

/media — точка монтирования внешних носителей. Например, когда вы вставляете диск в дисковод, он будет автоматически смонтирован в директорию /media/cdrom;

/mnt — точка временного монтирования. Файловые системы подключаемых устройств обычно монтируются в этот каталог для временного использования;

/opt — тут расположены дополнительные (необязательные) приложения. Такие программы обычно не подчиняются принятой иерархии и хранят свои файлы в одном подкаталоге (бинарные, библиотеки, конфигурации);

/proc — содержит файлы, хранящие информацию о запущенных процессах и о состоянии ядра ОС;

/root — директория, которая содержит файлы и личные настройки суперпользователя;

/run — содержит файлы состояния приложений. Например, PID-файлы или UNIX-сокеты;

/sbin — аналогично /bin содержит бинарные файлы. Утилиты нужны для настройки и администрирования системы суперпользователем;

/srv — содержит файлы сервисов, предоставляемых сервером (прим. FTP или Apache HTTP);

/sys — содержит данные непосредственно о системе. Тут можно узнать информацию о ядре, драйверах и устройствах;

/tmp — содержит временные файлы. Данные файлы доступны всем пользователям на чтение и запись. Стоит отметить, что данный каталог очищается при перезагрузке;

/usr — содержит пользовательские приложения и утилиты второго уровня, используемые пользователями, а не системой. Содержимое доступно только для чтения (кроме root). Каталог имеет вторичную иерархию и похож на корневой;

/var — содержит переменные файлы. Имеет подкаталоги, отвечающие за отдельные переменные. Например, логи будут храниться в /var/log, кэш в /var/cache, очереди заданий в /var/spool/ и так далее.

- Какая операция должна быть выполнена, чтобы содержимое некоторой файловой системы было доступно операционной системе?

Монтирование тома.

- Назовите основные причины нарушения целостности файловой системы. Как устранить повреждения файловой системы?

Отсутствие синхронизации между образом файловой системы в памяти и ее данными на диске в случае аварийного останова может привести к появлению следующих ошибок:

- Один блок адресуется несколькими mode (принадлежит нескольким файлам).
- Блок помечен как свободный, но в то же время занят (на него ссылается onode).
- Блок помечен как занятый, но в то же время свободен (ни один inode на него не ссылается).
- Неправильное число ссылок в inode (недостаток или избыток ссылающихся записей в каталогах).
- Несовпадение между размером файла и суммарным размером адресуемых inode блоков.
- Недопустимые адресуемые блоки (например, расположенные за пределами файловой системы).
- “Потерянные” файлы (правильные inode, на которые не ссылаются записи каталогов).
- Недопустимые или неразмещенные номера inode в записях каталогов.
- Как создаётся файловая система?

mkfs - позволяет создать файловую систему Linux.

- Дайте характеристику командам для просмотра текстовых файлов.

Cat - выводит содержимое файла на стандартное устройство вывода

- Приведите основные возможности команды cp в Linux.

Cp – копирует или перемещает директорию, файлы.

- Приведите основные возможности команды mv в Linux.

Mv - переименовать или переместить файл или директорию

- Что такое права доступа? Как они могут быть изменены?

Права доступа к файлу или каталогу можно изменить, воспользовавшись командой chmod. Сделать это может владелец файла (или каталога) или пользователь с правами администратора.

**Список литературы**

\1. 	Структура и типы файловых систем в Linux [Электронный ресурс]. URL: <https://selectel.ru/blog/directory-structure-linux/>.

\2. 	Типы файловых систем, их предназначение и отличия [Электронный ресурс]. URL: <https://timeweb.com/ru/community/articles/tipy-faylovyh-sistem-ih-prednaznachenie-i-otlichiya#:~:text=Основные%20файловые%20системы%2C%20используемые%20в,с%20редкими%20изменениями%20кодовой%20базы>.
